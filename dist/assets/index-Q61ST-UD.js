import{j as e,L as B,r as x,h as R,i as E,M as L,k as $,u as D,m as F,n as q}from"./index-kz_KmYqn.js";import{T as S,a as w,b as i,c as m,d as I,e as t,B as H,f as M}from"./table-5kSjqWcC.js";import{p as v,P as z}from"./paginate-BLkFUQMB.js";import{B as G,f as Q}from"./index-QesZtENi.js";import{C as O,a as k,b as P,d as T,c as A,e as U}from"./card-DezR5XwD.js";import{S as b}from"./separator-CSc1fs22.js";import{f as N}from"./currency-87vpqOrX.js";import"./index-BbPOWOnj.js";const J=({orders:n,onOrderSelect:o,selectedOrder:c})=>e.jsxs(S,{children:[e.jsx(w,{children:e.jsxs(i,{children:[e.jsx(m,{children:"Order ID"}),e.jsx(m,{className:"hidden sm:table-cell text-center",children:"Order Number"}),e.jsx(m,{className:"hidden sm:table-cell",children:"Customer"}),e.jsx(m,{className:"hidden sm:table-cell",children:"Status"}),e.jsx(m,{className:"hidden sm:table-cell",children:"Order taken by"}),e.jsx(m,{className:"hidden md:table-cell",children:"Date"})]})}),e.jsx(I,{children:n.map(a=>{var s,f,j,g,u,p,h;return e.jsxs(i,{className:`text-xs 2xl:text-sm ${c===a.id?"bg-accent":""}`,children:[e.jsx(t,{className:"font-medium",children:((s=a.orderStatus)==null?void 0:s.value)==="CREATED"&&a.customerId?e.jsx(B,{to:`${a.customerId}?orderId=${a.id}`,children:a.id}):e.jsx("div",{className:"cursor-pointer w-full h-full",onClick:()=>o==null?void 0:o(a.id),children:a.id})}),e.jsx(t,{className:"hidden sm:table-cell text-center",children:a.orderNumber}),e.jsxs(t,{className:"hidden md:table-cell",children:[e.jsx("div",{className:"font-medium",children:(f=a.customer)==null?void 0:f.name}),e.jsx("div",{className:"hidden text-muted-foreground md:inline",children:(j=a.customer)==null?void 0:j.contactNo})]}),e.jsx(t,{className:"hidden sm:table-cell",children:e.jsx(H,{variant:((g=a.orderStatus)==null?void 0:g.value)==="CANCELLED"?"secondary":"outline",children:(u=a.orderStatus)==null?void 0:u.value})}),e.jsx(t,{className:"hidden md:table-cell",children:`${(p=a.employee)==null?void 0:p.firstName} ${(h=a.employee)==null?void 0:h.lastName}`}),e.jsx(t,{className:"hidden md:table-cell",children:v(new Date(a.createdAt))})]},a.id)})})]}),K=J,V=({orderId:n,onClose:o})=>{var u,p,h,y;const[c,a]=x.useState(),[s,f]=x.useState(),j=x.useCallback(async l=>{try{const d=await R(l);a(d.data)}catch(d){console.log(d)}},[]),g=x.useCallback(async l=>{try{const d=await E(l);f(d.data)}catch(d){console.log(d)}},[]);return x.useEffect(()=>{n&&(j(n),g(n))},[n,j,g]),c?e.jsxs(O,{className:"overflow-hidden",children:[e.jsxs(k,{className:"flex flex-row items-start bg-muted/50 gap-4",children:[e.jsxs("div",{className:"grid gap-0.5",children:[e.jsx(P,{className:"group flex items-center gap-2 text-md",children:n}),e.jsxs(T,{children:["Date: ",v(new Date(c.createdAt))]})]}),e.jsx("div",{className:"ml-auto flex items-center gap-1",children:e.jsxs(G,{size:"icon",variant:"outline",className:"h-8 w-8",onClick:o,children:[e.jsx(L,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only",children:"Close"})]})})]}),e.jsxs(A,{className:"p-6 text-sm",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"font-semibold",children:"Order Details"}),e.jsxs(S,{className:"text-xs 2xl:text-sm",children:[e.jsx(w,{children:e.jsxs(i,{children:[e.jsx(m,{className:"hidden sm:table-cell",children:"Item"}),e.jsx(m,{className:"text-center",children:"Qty"}),e.jsx(m,{className:"text-right",children:"Price"}),e.jsx(m,{className:"text-right",children:"Amount"})]})}),e.jsx(I,{children:(u=c==null?void 0:c.items)==null?void 0:u.map(l=>e.jsxs(i,{children:[e.jsx(t,{className:"hidden sm:table-cell",children:l.itemName}),e.jsx(t,{className:"text-center flex items-center justify-center gap-2",children:l.quantity}),e.jsx(t,{className:"text-right",children:l.price}),e.jsx(t,{className:"text-right",children:N(l.quantity*l.price)})]},l.id))}),e.jsxs(M,{children:[e.jsxs(i,{children:[e.jsx(t,{children:"Sub total"}),e.jsx(t,{className:"text-center",children:(p=c==null?void 0:c.items)==null?void 0:p.reduce((l,d)=>l+d.quantity,0)}),e.jsx(t,{}),e.jsx(t,{className:"text-right",children:N((s==null?void 0:s.amount)||0)})]}),s!=null&&s.discount?e.jsxs(i,{className:"font-normal border-t border-dashed",children:[e.jsx(t,{children:"Discount"}),e.jsx(t,{}),e.jsx(t,{className:"text-center"}),e.jsx(t,{className:"text-right",children:N(s.discount||0)})]}):null,s!=null&&s.gst?e.jsxs(i,{className:"font-normal",children:[e.jsx(t,{children:"GST"}),e.jsx(t,{}),e.jsx(t,{className:"text-center",children:"5%"}),e.jsx(t,{className:"text-right",children:N(s.gst)})]}):null,s!=null&&s.serviceCharges?e.jsxs(i,{className:"font-normal",children:[e.jsx(t,{children:"Service charges"}),e.jsx(t,{}),e.jsx(t,{className:"text-center",children:"7%"}),e.jsx(t,{className:"text-right",children:N(s.serviceCharges)})]}):null,s!=null&&s.roundoffDiff?e.jsxs(i,{className:"font-normal",children:[e.jsx(t,{children:"Roundoff"}),e.jsx(t,{}),e.jsx(t,{className:"text-center"}),e.jsx(t,{className:"text-right",children:N(s.roundoffDiff)})]}):null,e.jsxs(i,{className:"border-t",children:[e.jsx(t,{children:"Total"}),e.jsx(t,{}),e.jsx(t,{className:"text-center"}),e.jsx(t,{className:"text-right",children:N((s==null?void 0:s.totalAmount)||0)})]})]})]})]}),(c==null?void 0:c.customer)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"my-4"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx("div",{className:"font-semibold",children:"Customer Information"}),e.jsxs("dl",{className:"grid gap-3 text-xs 2xl:text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("dt",{className:"text-muted-foreground",children:"Customer"}),e.jsx("dd",{children:c.customer.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("dt",{className:"text-muted-foreground",children:"Phone"}),e.jsx("dd",{children:e.jsx("a",{href:"tel:",children:Q(c.customer.contactNo)})})]})]})]})]}),(h=s==null?void 0:s.payments)!=null&&h.length?e.jsx(b,{className:"my-4"}):null,(y=s==null?void 0:s.payments)==null?void 0:y.map(l=>e.jsxs("div",{className:"grid gap-3",children:[e.jsx("div",{className:"font-semibold",children:"Payment Information"}),e.jsx("dl",{className:"grid gap-3 text-xs 2xl:text-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("dt",{className:"flex items-center gap-1 text-muted-foreground",children:l.paymentMode}),e.jsx("dd",{children:N(l.amountRecieved)})]})})]},l.id))]}),e.jsx(U,{className:"flex flex-row items-center border-t bg-muted/50 px-6 py-3",children:e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Updated"," ",e.jsx("time",{dateTime:new Date(c.updatedAt).toLocaleDateString(),children:v(new Date(c.updatedAt))})]})})]}):null},W=V;function ce(){const{shopId:n}=$(),[o,c]=x.useState([]),[a,s]=x.useState(""),f=D(r=>r.auth),[j,g]=x.useState(0),[u,p]=F(),h=parseInt(u.get("page")||"0"),y=20,l=x.useCallback(async r=>{try{const C=await q({shopId:r.shopId,orderStatusId:r.orderStatusId,isClosed:r.isClosed,employeeId:r.employeeId,skip:r.skip||0,take:r.take||y});console.log(C.data),g(C.data.count),c(C.data.orders)}catch(C){console.log(C)}},[]);x.useEffect(()=>{var r;if(n){const C=y*h;l({shopId:n,isClosed:!0,employeeId:(r=f.data)==null?void 0:r.id,skip:C,take:y})}},[n,l,f.data,h]);const d=r=>{console.log(r),p({...u,page:r.toString()})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between space-y-2",children:e.jsx("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"All Orders"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col flex-1 gap-4",children:[e.jsxs(O,{children:[e.jsxs(k,{className:"px-7",children:[e.jsx(P,{children:"Orders"}),e.jsxs(T,{children:["(Showing ",o.length,"/",j,") Recent orders from your store."]})]}),e.jsx(A,{children:e.jsx(K,{orders:o,onOrderSelect:s,selectedOrder:a})})]}),o.length?e.jsx(z,{totalCount:j,maxPages:5,itemsPerPage:y,value:h,onChange:d}):null]}),a&&e.jsx("div",{children:e.jsx(W,{orderId:a,onClose:()=>s("")})})]})]})}export{ce as default};
